\begin{algorithm}[!tb]
    \small
    \KwIn{$P_0\ \&\ P_1$ hold $b_{acc}$-bit $\ashare{X_q}$ with scale $s$.}
    \KwOut{$P_0\ \&\ P_1$ get $b_{acc}$-bit $\ashare{X'_q}$ with scale $s'$.}
    \caption{Secure Requantization, $\Pi_{\text{requant}}$}
    \label{alg:requant}
  
    $P_0$ and $P_1$ invoke extension protocol $\Pi_{\text{ext}}$~\cite{rathee2021sirnn} to increase bit-width from $b_{acc}$ to $b_{fix}$.
  
    $P_0$ and $P_1$ locally compute $X_{fix} = X_q \cdot \frac{s}{s'} \cdot 2^{s_{fix}}$ on their shares.
  
    $P_0$ and $P_1$ invoke the secure rounding protocol (Section~\ref{subsec:rounding}) to obtain $\ashare{X'_q}$, where $X'_q=\lfloor (X_q \cdot \frac{s}{s'} \cdot 2^{s_{fix}})/2^{s_{fix}} \rceil$.
  
    Return $\ashare{X'_q}$ (clipping is omitted as free lunch).
\end{algorithm}

\begin{algorithm}[!tb]
    \small
    \KwIn{$P_0\ \&\ P_1$ hold $b_{acc}$-bit $\ashare{X_q}$ with scale $s$.}
    \KwOut{$P_0\ \&\ P_1$ get $b_{fix}$-bit $\ashare{X_{f}}$.}
    \caption{Secure Requantization, $\Pi_{\text{requant}}$ (from $b_{acc}$ to $b_{fix}$)}
    \label{alg:requant_acc_fix}
  
    $P_0$ and $P_1$ invoke extension protocol $\Pi_{\text{ext}}$~\cite{rathee2021sirnn} to increase bit-width from $b_{acc}$ to $b_{fix}$.
  
    $P_0$ and $P_1$ locally compute $X_{f} = X_q \cdot s\cdot 2^{s_{fix}}$ on their shares.
  
    Return $\ashare{X_{f}}$.
\end{algorithm}

\begin{algorithm}[!tb]
    \small
    \KwIn{$P_0\ \&\ P_1$ hold $b_{fix}$-bit $\ashare{X_f}$.}
    \KwOut{$P_0\ \&\ P_1$ get $b_{acc}$-bit $\ashare{X'_q}$ with scale $s'$.}
    \caption{Secure Requantization, $\Pi_{\text{requant}}$ (from $b_{fix}$ to $b_{acc}$)}
    \label{alg:requant_fix_acc}
    
    $P_0$ and $P_1$ invoke extension protocol $\Pi_{\text{ext}}$~\cite{rathee2021sirnn} to increase bit-width from $b_{fix}$ to $2 \cdot b_{fix}$.
    
    $P_0$ and $P_1$ locally compute $X_f \cdot \frac{1}{s'} \cdot 2^{s_{fix}}$ on their shares.
    
    $P_0$ and $P_1$ invoke the secure rounding protocol $\Pi_{\text{round}}$ (Algorithm~\ref{alg:sec_round}) to obtain $\ashare{X'_q}$, where $X'_q=\lfloor X_f \cdot \frac{1}{s'} \cdot 2^{b_{fix}}/2^{2\cdot s_{fix}} \rceil$.
    
    Return $\ashare{X'_q}$ (clipping is omitted as free lunch).
\end{algorithm}